import{r as g}from"./index.RH_Wq4ov.js";import{u as v}from"./index.oU9ow8B_.js";import{t as s,a as m}from"./store.BNibPgoY.js";import{c as E}from"./store.BxErYl_R.js";function k(){const r=v(m),t=v(E);return g.useEffect(()=>{if(!r)return;s("page_view",{language:t});let i=0;const c=()=>{const n=window.scrollY,o=document.documentElement.scrollHeight-window.innerHeight,e=Math.round(n/o*100);e>i&&(i=e,[25,50,75,90].includes(e)&&s("scroll",{scrollDepth:e,language:t}))},a=new Set,l=new IntersectionObserver(n=>{n.forEach(o=>{if(o.isIntersecting&&o.intersectionRatio>.5){const e=o.target.id;e&&!a.has(e)&&(a.add(e),s("section_view",{section:e,language:t}))}})},{threshold:.5,rootMargin:"-10% 0px -10% 0px"}),f=Date.now(),d=()=>{},u=()=>{};window.addEventListener("scroll",c,{passive:!0}),window.addEventListener("blur",d),window.addEventListener("focus",u),window.addEventListener("visibilitychange",()=>{}),document.querySelectorAll("section[id]").forEach(n=>l.observe(n));const w=()=>{const n=Date.now()-f;s("page_view",{duration:n,language:t})};return window.addEventListener("beforeunload",w),()=>{window.removeEventListener("scroll",c),window.removeEventListener("blur",d),window.removeEventListener("focus",u),window.removeEventListener("beforeunload",w),l.disconnect()}},[r,t]),g.useEffect(()=>{r&&s("language_change",{language:t})},[t,r]),null}export{k as default};
